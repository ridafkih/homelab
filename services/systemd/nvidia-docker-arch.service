[Unit]
Description=Configure NVIDIA Container Toolkit for Docker with CDI
After=docker.service
Requires=docker.service

[Service]
Type=oneshot
ExecStartPre=/bin/mkdir -p /etc/cdi
ExecStart=/usr/bin/nvidia-ctk runtime configure --runtime=docker
ExecStart=/usr/bin/nvidia-ctk cdi generate --output=/etc/cdi/nvidia.yaml
ExecStart=/usr/bin/nvidia-ctk config --in-place --set nvidia-container-runtime.mode=cdi
RemainAfterExit=yes
User=root

[Install]
WantedBy=multi-user.target

